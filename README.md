# This example shows how to enable and disable rabbit consumers in runtime

## This application starts or stops a rabbitmq consumer every minute. If the current minute is odd, it turns the consumer off. Otherwise, it starts the consumer.

## It slightly implements the [clean architecture pattern](https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html) 

### Important notices:
1. To be able to start and stop a consumer, you must use the SimpleMessageListenerContainer (if you find any other way, just let me know)
2. The JSON expected to be posted in the queue is
```json
{
    "text": "message very important"
}
```
3. As the Jackson2JsonMessageConverter expects the property content_type to contain the text "json" and not always the producers set this property (sometimes it is being generated by another app or team), it was created the Jackson2JsonMessageConverterCustom that simple converts it no matter the property is set or not.
4. If you want to receive a converted object in your listener method, you have to set the Jackson2JsonMessageConverter. It could be one of the following (the second one must set the content_type property):
```java
Jackson2JsonMessageConverter jacksonConverter() {
  Jackson2JsonMessageConverter jacksonConverter = new Jackson2JsonMessageConverterCustom(ImportantMessage.class);
  return jacksonConverter;
}
```

```java
Jackson2JsonMessageConverter jacksonConverter() {
  Jackson2JsonMessageConverter jacksonConverter = new Jackson2JsonMessageConverter();
  return jacksonConverter;
}
```

## To run this application, just follow the next steps:
* Start up the docker-compose (make sure you have it properly started)
** Open the docker directory and run "docker-compose up"
* Start up the spring-boot application through the Application class


